{% extends 'layouts/base-presentation.html' %} {% block title %} Presentation {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %} {% block body_class %} index-page {% endblock body_class %} {% block content %}

<header class="header-2">
  <div class="page-header section-height-75 relative" style="background-image: url('/static/assets/img/curved-images/curved.jpg')">
    <div class="container">
      <div class="row">
        <div class="col-lg-7 text-center mx-auto">
          <h1 class="text-white pt-3 mt-n5">
            <a class="text-white" target="_blank" href="https://appseed.us/ui-kit/soft-ui-design-system">CV Analysis</a>
          </h1>
          <p class="lead text-white mt-3">description</p>
        </div>
      </div>
    </div>
    <div class="position-absolute w-100 z-index-1 bottom-0">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 40" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="moving-waves">
          <use xlink:href="#gentle-wave" x="48" y="-1" fill="rgba(255,255,255,0.40" />
          <use xlink:href="#gentle-wave" x="48" y="3" fill="rgba(255,255,255,0.35)" />
          <use xlink:href="#gentle-wave" x="48" y="5" fill="rgba(255,255,255,0.25)" />
          <use xlink:href="#gentle-wave" x="48" y="8" fill="rgba(255,255,255,0.20)" />
          <use xlink:href="#gentle-wave" x="48" y="13" fill="rgba(255,255,255,0.15)" />
          <use xlink:href="#gentle-wave" x="48" y="16" fill="rgba(255,255,255,0.95" />
        </g>
      </svg>
    </div>
  </div>
</header>
<section class="pt-3 pb-4" id="upload-cv">
  <div class="container">
    <div class="row">
      <div class="col-lg-9 z-index-2 border-radius-xl mt-n10 mx-auto py-3 blur shadow-blur">
        <div class="row">
          <div class="mb-3">
            <label for="formFile" class="form-label">Upload CV</label>
            <input class="form-control" type="file" id="formFile" />
          </div>
        </div>

        <div class="container py-3 mb-3">
          <div class="d-flex justify-content-center align-items-center">
            <div>
              <div class="form-check form-switch mb-0">
                <input class="form-check-input" type="checkbox" id="is_indonesia">
              </div>
            </div>
            <div class="ms-4">
              <span class="text-dark font-weight-bold d-block text-sm">Analysis in indonesian language</span>
              <span class="text-xs d-block" id="is_indonesia_status">OFF</span>
            </div>
          </div>
        </div>

        <div class="text-center">
          <button type="button" id="submit-button" class="btn bg-gradient-primary w-auto me-2">Upload</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Modal -->
<div class="modal fade" id="modal-notification" tabindex="-1" role="dialog" aria-labelledby="modal-notification" aria-hidden="true">
  <div class="modal-dialog modal-danger modal-dialog-centered modal-" role="document">
    <div class="modal-content">
      <div class="modal-header border-0">
        <h6 class="modal-title" id="modal-title-notification"></h6>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="text-primary">Ã—</span>
        </button>
      </div>
      <div class="modal-body border-0">
        <div class="py-3 text-center">
          <i class="ni ni-bell-55 ni-3x"></i>
          <h4 class="text-gradient text-danger mt-4" id="modal-description"></h4>
        </div>
      </div>
      <div class="modal-footer border-0">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Ok</button>
      </div>
    </div>
  </div>
</div>

  {% endblock content %}

  <!-- Specific JS goes HERE -->
  {% block javascripts %}

  <script src="/static/assets/js/soft-design-system.min.js?v=1.0.1" type="text/javascript"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      $('#submit-button').click(function () {
        var fileInput = $("#formFile")[0].files[0];
        var isIndonesia = $("#is_indonesia").prop("checked");

        if (fileInput) {
          var formData = new FormData();
          formData.append("file", fileInput);
          formData.append("is_indonesia", isIndonesia);

          $("#modal-title-notification").text("Sedang memproses...");
          $("#modal-description").html('<div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div>');
          $("#modal-notification").modal("show");

          $.ajax({
            url: "",
            type: "POST",
            data: formData,
            processData: false,
            contentType: false,
            success: function (response) {
              console.log(response);
              $("#modal-title-notification").text("Prediksi Berhasil");
              $("#modal-description").text(response.output);
              $("#modal-notification").modal("show");
            },
            error: function (error) {
              console.error("Error NYA INI:", error.responseJSON);
              $("#modal-title-notification").text("Prediksi Gagal");
              if(error.responseJSON == undefined){
                $("#modal-description").text("INTERNAL SERVER ERROR");
              } else {
                $("#modal-description").text(error.responseJSON.output);
              }
              $("#modal-notification").modal("show");
            },
          });
        } else {
          // File tidak dipilih
          console.error("Pilih file untuk diunggah.");
          $("#modal-title-notification").text("Prediksi Gagal");
          $("#modal-description").text("Pilih file untuk diunggah.");
          $("#modal-notification").modal("show");
        }
      });

      // Handle change event pada checkbox is_indonesia
      $("#is_indonesia").change(function () {
        var isIndonesia = $(this).prop("checked");
        var statusText = isIndonesia ? "ON" : "OFF";
        $("#is_indonesia_status").text(statusText);
      });
    });
  </script>


  {% endblock javascripts %}
</div>
